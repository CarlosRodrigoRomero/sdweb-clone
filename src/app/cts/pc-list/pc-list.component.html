<div class="search-div">
    <mat-form-field class="search-form-field" floatLabel="never">
        <input matInput [(ngModel)]="searchKey" placeholder="Buscar por ID" autocomplete="off" (keyup)="applyFilter()">
        <button mat-button matSuffix mat-icon-button aria-label="Clear" *ngIf="searchKey" (click)="onSearchClear()">
      <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
</div>


<div class="mat-elevation-z8">
    <table mat-table [dataSource]="pcDataSource" multiTemplateDataRows matSort>
        <ng-container matColumnDef="severidad">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Severidad </th>
            <td mat-cell *matCellDef="let element">
                <div class="circleSeveridad circleSeveridad{{element.severidad}}"></div>
                <!-- <span *ngIf="column !== 'severidad'">{{element[column]}}</span> </td> -->
        </ng-container>

        <ng-container matColumnDef="tipo">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
            <td mat-cell *matCellDef="let element">
                <span>{{pcDescripcion[element.tipo]}}</span> </td>
        </ng-container>

        <ng-container matColumnDef="perdidas">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Pérdidas </th>
            <td mat-cell *matCellDef="let element">
                <span style="color:red">- {{pcPerdidas[element.tipo]}} %</span> </td>
        </ng-container>

        <ng-container matColumnDef="local_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> #ID </th>
            <td mat-cell *matCellDef="let element">
                <span>{{element.local_id}}</span> </td>
        </ng-container>

        <ng-container matColumnDef="temperatura_real">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Temperatura máx. </th>
            <td mat-cell *matCellDef="let element">
                <span>{{element.temperatura_real}} ºC</span> </td>
        </ng-container>

        <ng-container matColumnDef="gradiente">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Gradiente </th>
            <td mat-cell *matCellDef="let element">
                <!-- <span>+ {{element.temperatura_real - element.temperaturaMedia | number: '2.0-1'}} ºC</span> -->
                <div class="progress">
                    <div class="progress-bar" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" [style.width]="getPercent(element) + '%'">
                        + {{element.gradiente | number: '1.0-1'}} ºC
                    </div>
                </div>


            </td>
        </ng-container>


        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length ">
                <div class="example-element-detail" [@detailExpand]="element==expandedElement ? 'expanded' : 'collapsed' ">

                    <app-pc-details [informe]="informe" [selectedPc]="expandedElement" [pc]="element"></app-pc-details>



                </div>
            </td>
        </ng-container>



        <tr mat-header-row *matHeaderRowDef="columnsToDisplay "></tr>
        <tr mat-row *matRowDef="let element; columns: columnsToDisplay; " class="example-element-row" [class.example-expanded-row]="expandedElement=== element" (click)="onClickToggleDetail(element)">
        </tr>
        <tr mat-row *matRowDef="let row; columns: [ 'expandedDetail'] " class="example-detail-row"></tr>

        <mat-paginator [pageSizeOptions]="[10,25,50,100] "></mat-paginator>
    </table>
    <mat-paginator [pageSizeOptions]="[10,25,50,100] "></mat-paginator>
</div>