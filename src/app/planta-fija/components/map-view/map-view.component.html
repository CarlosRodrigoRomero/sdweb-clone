<app-navbar></app-navbar>
<mat-sidenav-container class="main-container" [hasBackdrop]="false">
  <!-- SIDENAV FILTROS -->
  <mat-sidenav
    *ngIf="showFilters"
    #sidenavLeft
    [(opened)]="leftOpened"
    class="left-sidenav"
    [fixedInViewport]="true"
    position="start"
    disableClose
  >
    <div class="titulo">
      <h4>Filtros</h4>
    </div>
    <app-filters-panel></app-filters-panel>
  </mat-sidenav>

  <!-- SIDENAV LISTA ANOMALIAS -->
  <mat-sidenav
    #sidenavRight
    [(opened)]="rightOpened"
    class="right-sidenav"
    [fixedInViewport]="true"
    position="end"
    disableClose
  >
    <div class="titulo">
      <h4>Listado de anomalías</h4>
    </div>
    <app-anomalias-list></app-anomalias-list>
  </mat-sidenav>

  <!-- SIDENAV STATS -->
  <mat-sidenav
    #sidenavStats
    [(opened)]="statsOpened"
    class="stats-sidenav"
    [fixedInViewport]="true"
    position="end"
    disableClose
  >
    <app-planta-stats></app-planta-stats>
  </mat-sidenav>

  <mat-sidenav-content>
    <div *ngIf="anomaliasLoaded" class="rel">
      <!-- MAPA -->
      <app-map></app-map>

      <div>
        <div class="btns-export">
          <!-- BOTON COMPARTIR -->
          <app-share-map *ngIf="notSharedReport"></app-share-map>

          <!-- BOTON DESCARGAS -->
          <app-download-report></app-download-report>
        </div>

        <div class="map-control">
          <!-- CONTROL TEMPORAL -->
          <div class="temporal-control">
            <app-slider-temporal *ngIf="showFilters"></app-slider-temporal>
          </div>

          <!-- CONTROLES VISUALES -->
          <div class="visual-control">
            <app-thermal-slider></app-thermal-slider>
            <app-global-coord-areas></app-global-coord-areas>
            <app-slider-opacity></app-slider-opacity>
          </div>
        </div>
      </div>
    </div>

    <!-- BOTON SIDENAV FILTROS -->
    <div *ngIf="anomaliasLoaded">
      <button
        *ngIf="showFilters"
        mat-raised-button
        class="btn-left"
        (click)="sidenavLeft.toggle()"
        matTooltip="Filtros"
      >
        <mat-icon *ngIf="!leftOpened">keyboard_arrow_right</mat-icon>
        <mat-icon *ngIf="leftOpened">keyboard_arrow_left</mat-icon>
        <mat-icon>filter_alt</mat-icon>
      </button>

      <!-- BOTON SIDENAV LISTA ANOMALIAS -->
      <button
        mat-raised-button
        class="btn-right"
        (click)="sidenavRight.toggle()"
        matTooltip="Lista anomalías"
        [disabled]="statsOpened"
      >
        <mat-icon>list_alt</mat-icon>
        <mat-icon *ngIf="!rightOpened">keyboard_arrow_left</mat-icon>
        <mat-icon *ngIf="rightOpened">keyboard_arrow_right</mat-icon>
      </button>

      <!-- BOTON SIDENAV STATS -->
      <button
        mat-raised-button
        class="btn-right-stats"
        (click)="sidenavStats.toggle(); loadStats()"
        matTooltip="Estadísticas"
        [disabled]="rightOpened"
      >
        <mat-icon>query_stats</mat-icon>
        <mat-icon *ngIf="!statsOpened">keyboard_arrow_left</mat-icon>
        <mat-icon *ngIf="statsOpened">keyboard_arrow_right</mat-icon>
      </button>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
